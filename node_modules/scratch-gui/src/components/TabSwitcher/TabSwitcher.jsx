import React, { useState, useEffect, useRef} from 'react';

// ä¸²å£ç›‘è§†å™¨å†…å®¹
const SerialMonitor = ({ serialData }) => {
    const scrollRef = useRef(null);
  
    // æ¯æ¬¡æ•°æ®å˜åŒ–åè‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
    useEffect(() => {
      if (scrollRef.current) {
        scrollRef.current.scrollTop = scrollRef.current.scrollHeight;
      }
    }, [serialData]);
  
      // ğŸ’¡ ç»Ÿä¸€æ ¼å¼å¤„ç†ï¼šæŠŠå­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„
    const displayData = Array.isArray(serialData)
    ? serialData
    : typeof serialData === 'string'
    ? serialData.split('\n') // æŒ‰è¡Œåˆ‡å‰²
    : [];
    return (
      <div style={{}}>
        {/* <h4>ä¸²å£ç›‘è§†å™¨</h4> */}
        <div
          ref={scrollRef}
          style={{
            backgroundColor: '#000',
            color: '#0f0',
            height:'115px',
            overflowY: 'auto',
            fontFamily: 'monospace',
            borderRadius: '5px',
          }}
        >
          {displayData && displayData.length > 0 ? (
            displayData.map((line, index) => (
              <div key={index}>{line}</div>
            ))
          ) : (
            <div style={{ color: '#666' }}>æš‚æ— ä¸²å£æ•°æ®</div>
          )}
        </div>
      </div>
    );
  };

// ç¨‹åºä¸‹è½½ç•Œé¢
const ProgramDownload = () => {
  return (
    <div style={{ padding: '10px' }}>
      <div style={{ marginBottom: '10px' }}>
        <label>ç¨‹åºåç§°ï¼š</label>
        <input type="text" defaultValue="baoweijiayuan" />
      </div>
      <div style={{ marginBottom: '10px' }}>
        <label>ç¨‹åºå­˜å‚¨ä½ç½®ï¼š</label>
        <select>
          <option value="P1">P1</option>
          <option value="P2">P2</option>
          <option value="P3">P3</option>
        </select>
      </div>
      <button style={{ marginRight: '10px' }}>ä¸‹è½½ç¨‹åº</button>
      <button>ä¸‹è½½å¹¶è¿è¡Œ</button>
    </div>
  );
};

// ä¸»ç»„ä»¶ï¼šåˆ‡æ¢ Tabs
const TabSwitcher = ({ serialData }) => {
  const [activeTab, setActiveTab] = useState('download');

  return (
    <div style={{ width: '100%', height:'40vh',background: '#98F5FF', padding: '1px', borderRadius: '8px' }}>
      {/* Tabs */}
      <div style={{ display: 'flex', marginBottom: '1px' }}>
        <div
          onClick={() => setActiveTab('download')}
          style={{
            padding: '10px 20px',
            backgroundColor: activeTab === 'download' ? '#00F5FF' : '#AEEEEE',
            cursor: 'pointer',
            borderTopLeftRadius: '8px',  
            borderTopRightRadius: '8px',
            fontWeight: 'bold',
          }}
        >
          ç¨‹åºä¸‹è½½
        </div>
        <div
          onClick={() => setActiveTab('monitor')}
          style={{
            padding: '10px 20px',
            backgroundColor: activeTab === 'monitor' ? '#00F5FF' : '#AEEEEE',
            cursor: 'pointer',
            borderTopLeftRadius: '8px',
            borderTopRightRadius: '8px',
            fontWeight: 'bold',
          }}
        >
          ä¸²å£ç›‘è§†å™¨
        </div>
      </div>

      {/* Tab å†…å®¹åŒºåŸŸ */}
      <div style={{ backgroundColor: '#eee', padding: '20px', borderRadius: '0 0 8px 8px' }}>
        {activeTab === 'download' ? <ProgramDownload /> : <SerialMonitor serialData={serialData} />}
      </div>
    </div>
  );
};

export default TabSwitcher;
