import { promises as fs } from "fs";
import type { Dependency } from "./types";

export async function parseDependencies() {
  // Read package.json
  const packageJsonContent = await fs.readFile("package.json", "utf8");
  const packageJson = JSON.parse(packageJsonContent);
  // Extract dependencies and devDependencies
  const dependencies: Dependency[] = [
    ...Object.entries(packageJson.dependencies || {}).map(
      ([name, version]) => ({ name, version: version as string })
    ),
    ...Object.entries(packageJson.devDependencies || {}).map(
      ([name, version]) => ({ name, version: version as string })
    ),
  ];

  return dependencies;
}
