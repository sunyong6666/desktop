import chalk from "chalk";
import semver from "semver";

import { getValidSemverVersion } from "./util";
import { ValidatedString } from "./types";

export function displayUpdates(
  dependency: string,
  version: ValidatedString,
  latestVersion: ValidatedString
) {
  // Compare versions and handle version constraints
  const current = getValidSemverVersion(version);
  const latest = getValidSemverVersion(latestVersion);

  const canUpdate = current && latest && semver.lt(current, latest);

  if (canUpdate) {
    console.log(
      `${chalk.magenta(dependency)}: Current version ${chalk.red(
        version
      )}, Latest version ${chalk.green(
        latestVersion
      )}, Can update: ${chalk.green(canUpdate)}`
    );
  } else {
    console.log(
      `${chalk.magenta(dependency)}: Current version ${chalk.green(
        version
      )}, Latest version ${chalk.green(latestVersion)}, Can update: ${chalk.red(
        canUpdate
      )}`
    );
  }
}
